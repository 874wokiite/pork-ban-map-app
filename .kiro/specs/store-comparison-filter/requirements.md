# Requirements Document

## Introduction

本機能は、神戸豚饅マップにおける店舗比較・フィルター機能を提供する。従来のレーダーチャート表示から、対比スタイル（スペクトラム）の評価軸に基づいた新しいUI/UXへ移行する。

主な目的:
1. **店舗詳細モーダル**: スペクトラムバーによる直感的な特徴表示
2. **フィルター式マッチング**: ユーザーの好みに合った店舗を発見する機能

### 評価軸（対比スタイル）
| 軸 | 左側 (1-3) | 右側 (7-10) |
|---|---|---|
| skinStyle | 薄皮・ふわふわ | 厚皮・もちもち |
| fillingStyle | あっさり・野菜多め | こってり・肉感強め |
| overallTaste | 優しい味・上品 | パンチのある味・濃いめ |
| size | 小ぶり・食べ歩き向き | 大ぶり・満足感 |

---

## Requirements

### Requirement 1: スペクトラムバー表示
**Objective:** ユーザーとして、店舗の特徴を直感的に理解したい。これにより、各店舗の豚饅の傾向を一目で把握できる。

#### Acceptance Criteria

1.1 WHEN ユーザーが店舗詳細モーダルを開く THEN 豚饅マップシステム SHALL 4つの評価軸をスペクトラムバー形式で表示する

1.2 WHERE スペクトラムバーが表示される THE 豚饅マップシステム SHALL 各バーの両端に対比ラベル（例: 「薄皮ふわふわ」↔「厚皮もちもち」）を表示する

1.3 WHERE スペクトラムバーが表示される THE 豚饅マップシステム SHALL 店舗の評価値（1-10）に対応する位置にインジケーターを配置する

1.4 IF 店舗にaiAnalysisデータが存在しない THEN 豚饅マップシステム SHALL スペクトラムバーセクションを非表示にする

---

### Requirement 2: フィルター式マッチング機能
**Objective:** ユーザーとして、自分の好みを設定して合う店舗を見つけたい。これにより、「自分に合う豚饅店」を効率的に発見できる。

#### Acceptance Criteria

2.1 WHEN ユーザーがフィルター機能を開く THEN 豚饅マップシステム SHALL 4つの評価軸それぞれに対応するスライダーを表示する

2.2 WHERE 好みスライダーが表示される THE 豚饅マップシステム SHALL 各スライダーの両端に対比ラベルを表示する

2.3 WHEN ユーザーがスライダーを操作する THEN 豚饅マップシステム SHALL リアルタイムでマッチング結果を更新する

2.4 WHEN マッチング結果が計算される THEN 豚饅マップシステム SHALL 各店舗のマッチ度（%）を算出して表示する

2.5 WHEN マッチング結果が表示される THEN 豚饅マップシステム SHALL 店舗をマッチ度の高い順にソートして表示する

---

### Requirement 3: マッチ度計算ロジック
**Objective:** システムとして、ユーザーの好みと店舗特徴の類似度を正確に計算したい。これにより、信頼性の高いマッチング結果を提供できる。

#### Acceptance Criteria

3.1 WHEN マッチ度を計算する THEN 豚饅マップシステム SHALL ユーザー設定値と店舗の各評価軸の値の差分に基づいてスコアを算出する

3.2 WHERE マッチ度が算出される THE 豚饅マップシステム SHALL 4軸すべての類似度を統合した総合マッチ度を0-100%の範囲で表示する

3.3 IF 店舗にaiAnalysisデータが存在しない THEN 豚饅マップシステム SHALL その店舗をマッチング結果から除外する

---

### Requirement 4: フィルター機能のUI/UX
**Objective:** ユーザーとして、フィルター機能に簡単にアクセスしたい。これにより、店舗探しの体験がスムーズになる。

#### Acceptance Criteria

4.1 WHEN ユーザーがマップ画面にいる THEN 豚饅マップシステム SHALL フィルター機能へのアクセスボタンを表示する

4.2 WHEN ユーザーがフィルターボタンをタップする THEN 豚饅マップシステム SHALL フィルター設定モーダルを表示する

4.3 WHERE フィルターモーダルが表示される THE 豚饅マップシステム SHALL 好み設定スライダーとマッチング結果リストを同時に表示する

4.4 WHEN ユーザーがマッチング結果の店舗をタップする THEN 豚饅マップシステム SHALL その店舗の詳細モーダルを表示する

4.5 WHEN ユーザーがフィルターをリセットする THEN 豚饅マップシステム SHALL すべてのスライダーを中央値（5）に戻す

---

### Requirement 5: レスポンシブデザイン
**Objective:** ユーザーとして、どのデバイスでも快適に機能を使いたい。これにより、モバイルでもデスクトップでも同等の体験が得られる。

#### Acceptance Criteria

5.1 WHERE モバイルデバイスで表示される THE 豚饅マップシステム SHALL スペクトラムバーとスライダーをタッチ操作に最適化する

5.2 WHERE デスクトップで表示される THE 豚饅マップシステム SHALL マウス操作でスライダーを細かく調整できるようにする

5.3 WHILE 画面サイズが変更される THE 豚饅マップシステム SHALL UIコンポーネントのレイアウトを適切に調整する

---

### Requirement 6: パフォーマンス
**Objective:** システムとして、スムーズな操作体験を提供したい。これにより、ユーザーがストレスなく機能を利用できる。

#### Acceptance Criteria

6.1 WHEN スライダーが操作される THEN 豚饅マップシステム SHALL 100ms以内にマッチング結果を更新する

6.2 WHERE 店舗データが読み込まれる THE 豚饅マップシステム SHALL 既存のstores.jsonからaiAnalysisデータを取得する

6.3 IF 計算処理中である THEN 豚饅マップシステム SHALL ローディング状態を表示してユーザーに処理中であることを示す
